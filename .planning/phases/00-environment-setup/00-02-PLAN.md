---
phase: 00-environment-setup
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - .gitignore
  - src/__init__.py
  - src/data/__init__.py
  - src/data/download.py
  - src/models/__init__.py
  - src/fairness/__init__.py
  - tests/gates/.gitkeep
  - tests/unit/.gitkeep
  - data/raw/.gitkeep
  - data/processed/.gitkeep
  - data/exports/.gitkeep
  - outputs/figures/.gitkeep
  - notebooks/01_data_exploration.ipynb
  - notebooks/02_model_training.ipynb
  - notebooks/03_fairness_analysis.ipynb
  - notebooks/04_findings_visualization.ipynb
  - justfile
autonomous: true

must_haves:
  truths:
    - "Directory structure matches spec Section 3 exactly (src/data/, src/models/, src/fairness/, tests/gates/, tests/unit/, data/raw/, data/processed/, data/exports/, outputs/figures/)"
    - "`python src/data/download.py --help` or import resolves without error (script exists at correct location)"
    - "data/raw/ and data/processed/ are gitignored; data/exports/ is tracked"
    - ".envrc is NOT gitignored (direnv integration works)"
    - "All __init__.py files exist for Python packages (src/, src/data/, src/models/, src/fairness/)"
  artifacts:
    - path: "src/data/download.py"
      provides: "ENAHO + admin data download script"
      contains: "enahodata"
    - path: ".gitignore"
      provides: "Git exclusions per spec Section 3"
      contains: "data/raw/"
    - path: "justfile"
      provides: "Convenience commands for common tasks"
      contains: "uv sync"
    - path: "src/__init__.py"
      provides: "Python package marker"
    - path: "src/data/__init__.py"
      provides: "Python package marker"
    - path: "src/models/__init__.py"
      provides: "Python package marker"
    - path: "src/fairness/__init__.py"
      provides: "Python package marker"
  key_links:
    - from: "src/data/download.py"
      to: "data/raw/"
      via: "PROJECT_ROOT / data / raw path resolution"
      pattern: "data.*raw"
    - from: ".gitignore"
      to: "data/exports/"
      via: "NOT listed in gitignore (tracked)"
      pattern: "!data/exports"
---

<objective>
Create the complete directory scaffolding per spec Section 3, relocate download.py to its proper location, configure .gitignore with project-specific rules, create placeholder notebooks, and add a justfile for convenience commands.

Purpose: Establishes the project's physical structure so all subsequent phases can place files in the correct locations without creating directories.
Output: Full directory tree, relocated download script, proper .gitignore, placeholder notebooks, justfile.
</objective>

<execution_context>
@/home/hybridz/.claude/get-shit-done/workflows/execute-plan.md
@/home/hybridz/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/00-environment-setup/00-CONTEXT.md
@.planning/phases/00-environment-setup/00-RESEARCH.md
@download.py (existing script to be relocated)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create directory structure + __init__.py files + .gitignore</name>
  <files>
    src/__init__.py
    src/data/__init__.py
    src/models/__init__.py
    src/fairness/__init__.py
    tests/gates/.gitkeep
    tests/unit/.gitkeep
    data/raw/.gitkeep
    data/processed/.gitkeep
    data/exports/.gitkeep
    outputs/figures/.gitkeep
    .gitignore
  </files>
  <action>
**Create directories and marker files:**

Create all directories from spec Section 3:
```
src/
src/data/
src/models/
src/fairness/
tests/
tests/gates/
tests/unit/
data/
data/raw/
data/processed/
data/exports/
outputs/
outputs/figures/
notebooks/
```

Create `__init__.py` files for Python packages — each should be empty (no content needed):
- `src/__init__.py`
- `src/data/__init__.py`
- `src/models/__init__.py`
- `src/fairness/__init__.py`

Create `.gitkeep` files (empty) in directories that would otherwise be empty and untrackable:
- `tests/gates/.gitkeep`
- `tests/unit/.gitkeep`
- `data/raw/.gitkeep` (will be gitignored, but keeps structure)
- `data/processed/.gitkeep` (will be gitignored, but keeps structure)
- `data/exports/.gitkeep` (tracked — NOT gitignored)
- `outputs/figures/.gitkeep`

**Replace .gitignore with project-specific rules:**

The existing .gitignore is the GitHub Python template. Replace it entirely with a focused project-specific file matching spec Section 3:

```gitignore
# Data directories (large files, not tracked)
data/raw/
data/processed/

# Python
__pycache__/
*.py[codz]
*.egg-info/
dist/
build/

# Jupyter
.ipynb_checkpoints/

# Environment
.env
.venv/

# OS
.DS_Store

# Nix
result

# Temporary
.tmp_enaho_download/
```

**CRITICAL:** Do NOT include `.envrc` in .gitignore. The existing .gitignore has `.envrc` listed — this must be removed. The .envrc file must be tracked for direnv integration to work when others clone the repo.

**CRITICAL:** Do NOT include `data/exports/` in .gitignore. This directory is tracked (contains export JSON files for the M4 site).

**CRITICAL:** `uv.lock` must NOT be gitignored — it should be tracked for reproducibility.
  </action>
  <verify>
Verify all directories exist: `ls -d src/ src/data/ src/models/ src/fairness/ tests/gates/ tests/unit/ data/raw/ data/processed/ data/exports/ outputs/figures/ notebooks/`
Verify __init__.py files: `ls src/__init__.py src/data/__init__.py src/models/__init__.py src/fairness/__init__.py`
Verify .gitignore contains `data/raw/` and `data/processed/` but NOT `.envrc` and NOT `data/exports/`.
Run `git check-ignore data/raw/.gitkeep` → should be ignored.
Run `git check-ignore data/exports/.gitkeep` → should NOT be ignored (exit code 1).
Run `git check-ignore .envrc` → should NOT be ignored (exit code 1).
  </verify>
  <done>
All directories from spec Section 3 exist. All __init__.py files exist for Python packages. .gitignore excludes data/raw/ and data/processed/ but tracks data/exports/ and .envrc. No stale entries from the template .gitignore remain.
  </done>
</task>

<task type="auto">
  <name>Task 2: Relocate download.py + create notebooks + justfile</name>
  <files>
    src/data/download.py
    notebooks/01_data_exploration.ipynb
    notebooks/02_model_training.ipynb
    notebooks/03_fairness_analysis.ipynb
    notebooks/04_findings_visualization.ipynb
    justfile
  </files>
  <action>
**Relocate download.py from repo root to src/data/download.py:**

Move `download.py` (currently at project root) to `src/data/download.py`. Update the `PROJECT_ROOT` resolution to use a root-finding function that works from the new nested location:

```python
def _find_project_root():
    """Walk up from this file to find the project root (directory with pyproject.toml)."""
    path = Path(__file__).resolve().parent
    while path != path.parent:
        if (path / "pyproject.toml").exists():
            return path
        path = path.parent
    raise RuntimeError("Could not find project root (no pyproject.toml found)")

PROJECT_ROOT = _find_project_root()
```

Replace the existing line `PROJECT_ROOT = Path(__file__).resolve().parent.parent` with this function + call. The rest of the script should work as-is since it derives all paths from PROJECT_ROOT. Also update the docstring's Usage section to reflect the new location (`python src/data/download.py`).

After creating `src/data/download.py`, delete the old `download.py` from the project root using `git rm download.py` (it's tracked).

**Create 4 placeholder Jupyter notebooks:**

Each notebook should have a single markdown cell with the title. Use minimal valid .ipynb JSON structure:

- `notebooks/01_data_exploration.ipynb` — title: "# 01 - Data Exploration"
- `notebooks/02_model_training.ipynb` — title: "# 02 - Model Training"
- `notebooks/03_fairness_analysis.ipynb` — title: "# 03 - Fairness Analysis"
- `notebooks/04_findings_visualization.ipynb` — title: "# 04 - Findings Visualization"

Each notebook: nbformat 4, nbformat_minor 5, Python 3 kernel, single markdown cell with title.

**Create justfile with convenience commands:**

```just
# Alerta Escuela Equity Audit

# Install Python dependencies
sync:
    uv sync

# Run all tests
test:
    uv run pytest tests/

# Run gate tests only
gates:
    uv run pytest tests/gates/ -v

# Run unit tests only
unit:
    uv run pytest tests/unit/ -v

# Download ENAHO + admin data
download:
    uv run python src/data/download.py

# Lint code
lint:
    ruff check src/ tests/

# Format code
fmt:
    ruff format src/ tests/

# Start JupyterLab
lab:
    uv run jupyter lab
```
  </action>
  <verify>
`test -f src/data/download.py` → exists.
`test ! -f download.py` → old location removed.
`grep "pyproject.toml" src/data/download.py` → root-finding function present.
`python -c "import json; json.load(open('notebooks/01_data_exploration.ipynb'))"` → valid JSON.
`ls notebooks/*.ipynb | wc -l` → 4 notebooks.
`test -f justfile` → exists.
`grep "uv sync" justfile` → sync command present.
  </verify>
  <done>
download.py relocated to src/data/download.py with updated PROJECT_ROOT resolution. Old download.py removed. Four placeholder notebooks created. Justfile provides sync, test, gates, unit, download, lint, fmt, lab commands.
  </done>
</task>

</tasks>

<verification>
1. Directory structure matches spec:
   `ls -R src/ tests/ data/ outputs/ notebooks/` shows all expected directories and files.

2. Git tracking is correct:
   - `git check-ignore data/raw/test` → ignored
   - `git check-ignore data/processed/test` → ignored
   - `git check-ignore data/exports/test` → NOT ignored (exit 1)
   - `git check-ignore .envrc` → NOT ignored (exit 1)

3. Download script works from new location:
   `python -c "from pathlib import Path; exec(open('src/data/download.py').read().split('def main')[0]); print(PROJECT_ROOT)"` → prints project root.

4. All Python packages importable:
   `python -c "import src; import src.data; import src.models; import src.fairness"` → no errors.

5. Notebooks are valid:
   `python -c "import json; [json.load(open(f'notebooks/0{i}_{n}.ipynb')) for i, n in [(1,'data_exploration'),(2,'model_training'),(3,'fairness_analysis'),(4,'findings_visualization')]]"` → no errors.
</verification>

<success_criteria>
- All directories from spec Section 3 exist
- All __init__.py files present for Python packages
- download.py lives at src/data/download.py with working root-finding
- Old download.py removed from repo root
- .gitignore excludes data/raw/, data/processed/ but NOT data/exports/, .envrc
- Four placeholder notebooks exist with valid JSON
- justfile provides convenience commands
</success_criteria>

<output>
After completion, create `.planning/phases/00-environment-setup/00-02-SUMMARY.md`
</output>
