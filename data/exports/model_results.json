{
  "logistic_regression": {
    "metadata": {
      "model_type": "LogisticRegression",
      "train_years": [
        2018,
        2019,
        2020,
        2021
      ],
      "validate_year": 2022,
      "test_year": 2023,
      "n_train": 98023,
      "n_validate": 26477,
      "n_test": 25635,
      "n_features": 25,
      "feature_names": [
        "age",
        "is_secundaria_age",
        "es_mujer",
        "lang_castellano",
        "lang_quechua",
        "lang_aimara",
        "lang_other_indigenous",
        "lang_foreign",
        "rural",
        "is_sierra",
        "is_selva",
        "district_dropout_rate_admin_z",
        "nightlight_intensity_z",
        "poverty_index_z",
        "poverty_quintile",
        "es_peruano",
        "has_disability",
        "is_working",
        "juntos_participant",
        "log_income",
        "parent_education_years",
        "census_indigenous_lang_pct_z",
        "census_literacy_rate_z",
        "census_electricity_pct_z",
        "census_water_access_pct_z"
      ],
      "class_weight": "balanced",
      "solver": "lbfgs",
      "max_iter": 1000,
      "C": 1.0,
      "n_iter_actual": 307,
      "convergence": true,
      "year_shift_note": "ENAHO 2024 unavailable; train/val/test shifted back by 1 year from spec",
      "covid_note": "2020 has reduced sample (~13,755 rows) due to COVID phone interviews",
      "weight_note": "freq_weights inflates effective n to ~25M; all p-values are effectively 0. Use odds ratios and coefficient signs for interpretation.",
      "generated_at": "2026-02-08T08:01:40.796327+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.210316,
          "roc_auc": 0.604089,
          "f1": 0.287655,
          "precision": 0.206469,
          "recall": 0.47406,
          "brier": 0.238672,
          "log_loss": 0.670755
        },
        "unweighted": {
          "pr_auc": 0.207701,
          "roc_auc": 0.607024,
          "f1": 0.288733,
          "precision": 0.198313,
          "recall": 0.530709,
          "brier": 0.24923,
          "log_loss": 0.692769
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.19269,
          "roc_auc": 0.598371,
          "f1": 0.270491,
          "precision": 0.194087,
          "recall": 0.446101,
          "brier": 0.237229,
          "log_loss": 0.667752
        },
        "unweighted": {
          "pr_auc": 0.195059,
          "roc_auc": 0.600727,
          "f1": 0.272932,
          "precision": 0.187533,
          "recall": 0.501143,
          "brier": 0.247346,
          "log_loss": 0.688766
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.516815,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.24823395678436225,
          "weighted_precision": 0.14176091896785625,
          "weighted_recall": 0.9972226352114602,
          "unweighted_f1": 0.25168673104908057,
          "unweighted_precision": 0.1439869825172179,
          "unweighted_recall": 0.9986876640419947
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.2561536704619681,
          "weighted_precision": 0.14984150477203917,
          "weighted_recall": 0.8817604917570832,
          "unweighted_f1": 0.2585435009700045,
          "unweighted_precision": 0.1506914847351483,
          "unweighted_recall": 0.9094488188976378
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.28129326746397165,
          "weighted_precision": 0.19160113696567818,
          "weighted_recall": 0.5288650310229124,
          "unweighted_f1": 0.28461197900196067,
          "unweighted_precision": 0.18748437630197484,
          "unweighted_recall": 0.5905511811023622
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.22891932113780697,
          "weighted_precision": 0.26030827003969725,
          "weighted_recall": 0.2042857750933075,
          "unweighted_f1": 0.24678529679179115,
          "unweighted_precision": 0.24427873489328877,
          "unweighted_recall": 0.24934383202099739
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.06359364601802964,
          "weighted_precision": 0.30780731142314954,
          "weighted_recall": 0.035459864798751524,
          "unweighted_f1": 0.0865128660159716,
          "unweighted_precision": 0.2793696275071633,
          "unweighted_recall": 0.051181102362204724
        },
        {
          "threshold": 0.516815,
          "is_optimal": true,
          "weighted_f1": 0.2876547664657711,
          "weighted_precision": 0.20646898819120424,
          "weighted_recall": 0.47406024015575454,
          "unweighted_f1": 0.2887333999714408,
          "unweighted_precision": 0.19831306394664575,
          "unweighted_recall": 0.5307086614173229
        }
      ]
    },
    "coefficients": [
      {
        "feature": "intercept",
        "coefficient": -1.540998,
        "std_error": 0.026339,
        "odds_ratio": 0.214167,
        "p_value": 0.0,
        "ci_lower": -1.592621,
        "ci_upper": -1.489375
      },
      {
        "feature": "age",
        "coefficient": 0.120129,
        "std_error": 0.000333,
        "odds_ratio": 1.127642,
        "p_value": 0.0,
        "ci_lower": 0.119477,
        "ci_upper": 0.12078
      },
      {
        "feature": "is_secundaria_age",
        "coefficient": -0.437803,
        "std_error": 0.002289,
        "odds_ratio": 0.645453,
        "p_value": 0.0,
        "ci_lower": -0.442289,
        "ci_upper": -0.433316
      },
      {
        "feature": "es_mujer",
        "coefficient": -0.043797,
        "std_error": 0.001078,
        "odds_ratio": 0.957148,
        "p_value": 0.0,
        "ci_lower": -0.04591,
        "ci_upper": -0.041684
      },
      {
        "feature": "lang_castellano",
        "coefficient": 0.295223,
        "std_error": 0.013153,
        "odds_ratio": 1.343425,
        "p_value": 0.0,
        "ci_lower": 0.269443,
        "ci_upper": 0.321002
      },
      {
        "feature": "lang_quechua",
        "coefficient": 0.471329,
        "std_error": 0.013316,
        "odds_ratio": 1.602122,
        "p_value": 0.0,
        "ci_lower": 0.445231,
        "ci_upper": 0.497427
      },
      {
        "feature": "lang_aimara",
        "coefficient": 0.346508,
        "std_error": 0.01534,
        "odds_ratio": 1.414121,
        "p_value": 0.0,
        "ci_lower": 0.316443,
        "ci_upper": 0.376574
      },
      {
        "feature": "lang_other_indigenous",
        "coefficient": 0.788016,
        "std_error": 0.013719,
        "odds_ratio": 2.199029,
        "p_value": 0.0,
        "ci_lower": 0.761127,
        "ci_upper": 0.814905
      },
      {
        "feature": "lang_foreign",
        "coefficient": 0.575964,
        "std_error": 0.016696,
        "odds_ratio": 1.778845,
        "p_value": 0.0,
        "ci_lower": 0.543241,
        "ci_upper": 0.608688
      },
      {
        "feature": "rural",
        "coefficient": -0.009975,
        "std_error": 0.001601,
        "odds_ratio": 0.990074,
        "p_value": 0.0,
        "ci_lower": -0.013113,
        "ci_upper": -0.006838
      },
      {
        "feature": "is_sierra",
        "coefficient": -0.072235,
        "std_error": 0.001695,
        "odds_ratio": 0.930312,
        "p_value": 0.0,
        "ci_lower": -0.075558,
        "ci_upper": -0.068912
      },
      {
        "feature": "is_selva",
        "coefficient": -0.077228,
        "std_error": 0.002075,
        "odds_ratio": 0.925679,
        "p_value": 0.0,
        "ci_lower": -0.081294,
        "ci_upper": -0.073161
      },
      {
        "feature": "district_dropout_rate_admin_z",
        "coefficient": -0.003094,
        "std_error": 0.000865,
        "odds_ratio": 0.996911,
        "p_value": 0.00035,
        "ci_lower": -0.00479,
        "ci_upper": -0.001398
      },
      {
        "feature": "nightlight_intensity_z",
        "coefficient": -0.107377,
        "std_error": 0.000652,
        "odds_ratio": 0.898187,
        "p_value": 0.0,
        "ci_lower": -0.108655,
        "ci_upper": -0.106099
      },
      {
        "feature": "poverty_index_z",
        "coefficient": 0.252479,
        "std_error": 0.001704,
        "odds_ratio": 1.287212,
        "p_value": 0.0,
        "ci_lower": 0.249138,
        "ci_upper": 0.255819
      },
      {
        "feature": "poverty_quintile",
        "coefficient": -0.210036,
        "std_error": 0.001226,
        "odds_ratio": 0.810555,
        "p_value": 0.0,
        "ci_lower": -0.21244,
        "ci_upper": -0.207632
      },
      {
        "feature": "es_peruano",
        "coefficient": 0.298483,
        "std_error": 0.020422,
        "odds_ratio": 1.347813,
        "p_value": 0.0,
        "ci_lower": 0.258456,
        "ci_upper": 0.33851
      },
      {
        "feature": "has_disability",
        "coefficient": 0.114813,
        "std_error": 0.001708,
        "odds_ratio": 1.121664,
        "p_value": 0.0,
        "ci_lower": 0.111465,
        "ci_upper": 0.118161
      },
      {
        "feature": "is_working",
        "coefficient": 0.346023,
        "std_error": 0.001814,
        "odds_ratio": 1.413436,
        "p_value": 0.0,
        "ci_lower": 0.342469,
        "ci_upper": 0.349578
      },
      {
        "feature": "juntos_participant",
        "coefficient": -0.033495,
        "std_error": 0.001581,
        "odds_ratio": 0.96706,
        "p_value": 0.0,
        "ci_lower": -0.036593,
        "ci_upper": -0.030397
      },
      {
        "feature": "log_income",
        "coefficient": -0.107299,
        "std_error": 0.000861,
        "odds_ratio": 0.898257,
        "p_value": 0.0,
        "ci_lower": -0.108987,
        "ci_upper": -0.105611
      },
      {
        "feature": "parent_education_years",
        "coefficient": -0.001809,
        "std_error": 0.000154,
        "odds_ratio": 0.998193,
        "p_value": 0.0,
        "ci_lower": -0.00211,
        "ci_upper": -0.001508
      },
      {
        "feature": "census_indigenous_lang_pct_z",
        "coefficient": 0.021599,
        "std_error": 0.000898,
        "odds_ratio": 1.021834,
        "p_value": 0.0,
        "ci_lower": 0.019839,
        "ci_upper": 0.023358
      },
      {
        "feature": "census_literacy_rate_z",
        "coefficient": -0.051628,
        "std_error": 0.000931,
        "odds_ratio": 0.949682,
        "p_value": 0.0,
        "ci_lower": -0.053453,
        "ci_upper": -0.049803
      },
      {
        "feature": "census_electricity_pct_z",
        "coefficient": 0.091742,
        "std_error": 0.00097,
        "odds_ratio": 1.096082,
        "p_value": 0.0,
        "ci_lower": 0.089841,
        "ci_upper": 0.093644
      },
      {
        "feature": "census_water_access_pct_z",
        "coefficient": -0.053554,
        "std_error": 0.000833,
        "odds_ratio": 0.947854,
        "p_value": 0.0,
        "ci_lower": -0.055187,
        "ci_upper": -0.051922
      }
    ]
  },
  "lightgbm": {
    "metadata": {
      "model_type": "LGBMClassifier",
      "train_years": [
        2018,
        2019,
        2020,
        2021
      ],
      "validate_year": 2022,
      "test_year": 2023,
      "n_train": 98023,
      "n_validate": 26477,
      "n_test": 25635,
      "n_features": 25,
      "feature_names": [
        "age",
        "is_secundaria_age",
        "es_mujer",
        "lang_castellano",
        "lang_quechua",
        "lang_aimara",
        "lang_other_indigenous",
        "lang_foreign",
        "rural",
        "is_sierra",
        "is_selva",
        "district_dropout_rate_admin_z",
        "nightlight_intensity_z",
        "poverty_index_z",
        "poverty_quintile",
        "es_peruano",
        "has_disability",
        "is_working",
        "juntos_participant",
        "log_income",
        "parent_education_years",
        "census_indigenous_lang_pct_z",
        "census_literacy_rate_z",
        "census_electricity_pct_z",
        "census_water_access_pct_z"
      ],
      "best_iteration": 79,
      "scale_pos_weight": 4.8019,
      "optuna_n_trials": 100,
      "optuna_best_trial": 71,
      "optuna_best_params": {
        "learning_rate": 0.03587489792330485,
        "num_leaves": 18,
        "max_depth": 11,
        "min_child_samples": 83,
        "subsample": 0.6802794615653794,
        "colsample_bytree": 0.7747745750228865,
        "reg_alpha": 0.00017504640681749705,
        "reg_lambda": 5.112692760310743e-07
      },
      "calibration_note": "scale_pos_weight distorts probability estimates; Phase 7 handles calibration",
      "generated_at": "2026-02-08T16:34:06.194963+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.261064,
          "roc_auc": 0.650491,
          "f1": 0.316243,
          "precision": 0.264248,
          "recall": 0.393714,
          "brier": 0.211542,
          "log_loss": 0.614395
        },
        "unweighted": {
          "pr_auc": 0.257999,
          "roc_auc": 0.646491,
          "f1": 0.317427,
          "precision": 0.251146,
          "recall": 0.431234,
          "brier": 0.219322,
          "log_loss": 0.631009
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.23781,
          "roc_auc": 0.631401,
          "f1": 0.299348,
          "precision": 0.248704,
          "recall": 0.375893,
          "brier": 0.211071,
          "log_loss": 0.613788
        },
        "unweighted": {
          "pr_auc": 0.230583,
          "roc_auc": 0.62621,
          "f1": 0.286632,
          "precision": 0.224878,
          "recall": 0.395143,
          "brier": 0.21978,
          "log_loss": 0.632012
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.50399,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.25170886723270014,
          "weighted_precision": 0.1445265254428582,
          "weighted_recall": 0.9741438812081661,
          "unweighted_f1": 0.25331985170205595,
          "unweighted_precision": 0.14532095901005415,
          "unweighted_recall": 0.9863517060367454
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.2763538197187848,
          "weighted_precision": 0.16635495695788377,
          "weighted_recall": 0.8157561030360858,
          "unweighted_f1": 0.27463267984926115,
          "unweighted_precision": 0.16372999444640784,
          "unweighted_recall": 0.8511811023622047
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.31390998682997756,
          "weighted_precision": 0.25673437266739835,
          "weighted_recall": 0.40384839105360215,
          "unweighted_f1": 0.3149015932521087,
          "unweighted_precision": 0.24489795918367346,
          "unweighted_recall": 0.4409448818897638
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.28622904457822157,
          "weighted_precision": 0.33937913211804377,
          "weighted_recall": 0.2474724424861987,
          "unweighted_f1": 0.2893250074338388,
          "unweighted_precision": 0.3336762688614541,
          "unweighted_recall": 0.2553805774278215
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.135200337560806,
          "weighted_precision": 0.41701719152340205,
          "weighted_recall": 0.08067847499246213,
          "unweighted_f1": 0.14442767837896098,
          "unweighted_precision": 0.4041013268998794,
          "unweighted_recall": 0.08792650918635171
        },
        {
          "threshold": 0.50399,
          "is_optimal": true,
          "weighted_f1": 0.31673037259399067,
          "weighted_precision": 0.26459898346182326,
          "weighted_recall": 0.3944438439389667,
          "unweighted_f1": 0.31755843152404867,
          "unweighted_precision": 0.25122249388753054,
          "unweighted_recall": 0.431496062992126
        }
      ]
    },
    "feature_importances": [
      {
        "feature": "age",
        "importance": 0.258521
      },
      {
        "feature": "nightlight_intensity_z",
        "importance": 0.122662
      },
      {
        "feature": "census_electricity_pct_z",
        "importance": 0.093094
      },
      {
        "feature": "poverty_index_z",
        "importance": 0.084407
      },
      {
        "feature": "census_literacy_rate_z",
        "importance": 0.083947
      },
      {
        "feature": "census_indigenous_lang_pct_z",
        "importance": 0.081832
      },
      {
        "feature": "census_water_access_pct_z",
        "importance": 0.07908
      },
      {
        "feature": "is_working",
        "importance": 0.056065
      },
      {
        "feature": "log_income",
        "importance": 0.05551
      },
      {
        "feature": "district_dropout_rate_admin_z",
        "importance": 0.027829
      },
      {
        "feature": "lang_other_indigenous",
        "importance": 0.013805
      },
      {
        "feature": "rural",
        "importance": 0.007966
      },
      {
        "feature": "lang_castellano",
        "importance": 0.007004
      },
      {
        "feature": "parent_education_years",
        "importance": 0.005715
      },
      {
        "feature": "has_disability",
        "importance": 0.005363
      },
      {
        "feature": "is_sierra",
        "importance": 0.004097
      },
      {
        "feature": "is_secundaria_age",
        "importance": 0.00399
      },
      {
        "feature": "is_selva",
        "importance": 0.003083
      },
      {
        "feature": "es_mujer",
        "importance": 0.002595
      },
      {
        "feature": "poverty_quintile",
        "importance": 0.00178
      },
      {
        "feature": "juntos_participant",
        "importance": 0.00129
      },
      {
        "feature": "lang_quechua",
        "importance": 0.000366
      },
      {
        "feature": "lang_aimara",
        "importance": 0.0
      },
      {
        "feature": "lang_foreign",
        "importance": 0.0
      },
      {
        "feature": "es_peruano",
        "importance": 0.0
      }
    ],
    "test_2023_final": {
      "weighted": {
        "pr_auc": 0.23781,
        "roc_auc": 0.631401,
        "f1": 0.299348,
        "precision": 0.248704,
        "recall": 0.375893,
        "brier": 0.211071,
        "log_loss": 0.613788
      },
      "unweighted": {
        "pr_auc": 0.230583,
        "roc_auc": 0.62621,
        "f1": 0.286632,
        "precision": 0.224878,
        "recall": 0.395143,
        "brier": 0.21978,
        "log_loss": 0.632012
      }
    }
  },
  "xgboost": {
    "metadata": {
      "model_type": "XGBClassifier",
      "train_years": [
        2018,
        2019,
        2020,
        2021
      ],
      "validate_year": 2022,
      "test_year": 2023,
      "n_train": 98023,
      "n_validate": 26477,
      "n_test": 25635,
      "n_features": 25,
      "feature_names": [
        "age",
        "is_secundaria_age",
        "es_mujer",
        "lang_castellano",
        "lang_quechua",
        "lang_aimara",
        "lang_other_indigenous",
        "lang_foreign",
        "rural",
        "is_sierra",
        "is_selva",
        "district_dropout_rate_admin_z",
        "nightlight_intensity_z",
        "poverty_index_z",
        "poverty_quintile",
        "es_peruano",
        "has_disability",
        "is_working",
        "juntos_participant",
        "log_income",
        "parent_education_years",
        "census_indigenous_lang_pct_z",
        "census_literacy_rate_z",
        "census_electricity_pct_z",
        "census_water_access_pct_z"
      ],
      "best_iteration": 50,
      "scale_pos_weight": 4.8019,
      "optuna_n_trials": 50,
      "optuna_best_trial": 43,
      "optuna_best_params": {
        "learning_rate": 0.03246825269650538,
        "max_depth": 5,
        "min_child_weight": 9,
        "gamma": 0.22609157031629112,
        "subsample": 0.7778644065097173,
        "colsample_bytree": 0.892598796178231,
        "reg_alpha": 6.532183971249823e-07,
        "reg_lambda": 0.0005961554999173771
      },
      "calibration_note": "scale_pos_weight distorts probability estimates; Phase 7 handles calibration",
      "generated_at": "2026-02-08T16:35:10.315678+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.261208,
          "roc_auc": 0.644501,
          "f1": 0.312024,
          "precision": 0.243941,
          "recall": 0.432823,
          "brier": 0.226761,
          "log_loss": 0.646298
        },
        "unweighted": {
          "pr_auc": 0.261139,
          "roc_auc": 0.639323,
          "f1": 0.313749,
          "precision": 0.232532,
          "recall": 0.482152,
          "brier": 0.234351,
          "log_loss": 0.661986
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.24289,
          "roc_auc": 0.627886,
          "f1": 0.292311,
          "precision": 0.226497,
          "recall": 0.412039,
          "brier": 0.226318,
          "log_loss": 0.645518
        },
        "unweighted": {
          "pr_auc": 0.235563,
          "roc_auc": 0.624252,
          "f1": 0.288221,
          "precision": 0.211877,
          "recall": 0.450571,
          "brier": 0.23454,
          "log_loss": 0.662407
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.499221,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.2497243473630708,
          "weighted_precision": 0.1428492958682437,
          "weighted_recall": 0.9916246415541711,
          "unweighted_f1": 0.25199203187250996,
          "unweighted_precision": 0.14424173318129987,
          "unweighted_recall": 0.9960629921259843
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.25724224931249634,
          "weighted_precision": 0.1487682712202592,
          "weighted_recall": 0.9497494991025669,
          "unweighted_f1": 0.25613719659774564,
          "unweighted_precision": 0.1474992035680153,
          "unweighted_recall": 0.9721784776902888
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.31018618877242726,
          "weighted_precision": 0.2437403855425726,
          "weighted_recall": 0.42643661331973604,
          "unweighted_f1": 0.31412078917894376,
          "unweighted_precision": 0.23380787482365012,
          "unweighted_recall": 0.4784776902887139
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.28207424559255156,
          "weighted_precision": 0.35756886899257984,
          "weighted_recall": 0.232901112054546,
          "unweighted_f1": 0.28684127485011046,
          "unweighted_precision": 0.35957278481012656,
          "unweighted_recall": 0.23858267716535433
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.05132332541154968,
          "weighted_precision": 0.4282154645277013,
          "weighted_recall": 0.027297520893784847,
          "unweighted_f1": 0.05517241379310345,
          "unweighted_precision": 0.448,
          "unweighted_recall": 0.029396325459317585
        },
        {
          "threshold": 0.499221,
          "is_optimal": true,
          "weighted_f1": 0.3120238148280821,
          "weighted_precision": 0.24394094266740585,
          "weighted_recall": 0.43282280593957556,
          "unweighted_f1": 0.31374893253629377,
          "unweighted_precision": 0.23253164556962025,
          "unweighted_recall": 0.4821522309711286
        }
      ]
    },
    "feature_importances": [
      {
        "feature": "age",
        "importance": 0.20131
      },
      {
        "feature": "is_working",
        "importance": 0.106817
      },
      {
        "feature": "lang_other_indigenous",
        "importance": 0.06644
      },
      {
        "feature": "nightlight_intensity_z",
        "importance": 0.049578
      },
      {
        "feature": "census_literacy_rate_z",
        "importance": 0.044323
      },
      {
        "feature": "census_electricity_pct_z",
        "importance": 0.043277
      },
      {
        "feature": "census_indigenous_lang_pct_z",
        "importance": 0.041117
      },
      {
        "feature": "is_secundaria_age",
        "importance": 0.040961
      },
      {
        "feature": "census_water_access_pct_z",
        "importance": 0.037867
      },
      {
        "feature": "lang_castellano",
        "importance": 0.035839
      },
      {
        "feature": "poverty_index_z",
        "importance": 0.034688
      },
      {
        "feature": "is_selva",
        "importance": 0.03339
      },
      {
        "feature": "rural",
        "importance": 0.031735
      },
      {
        "feature": "log_income",
        "importance": 0.027993
      },
      {
        "feature": "has_disability",
        "importance": 0.027925
      },
      {
        "feature": "is_sierra",
        "importance": 0.025349
      },
      {
        "feature": "lang_quechua",
        "importance": 0.023665
      },
      {
        "feature": "district_dropout_rate_admin_z",
        "importance": 0.020482
      },
      {
        "feature": "es_mujer",
        "importance": 0.020218
      },
      {
        "feature": "parent_education_years",
        "importance": 0.01846
      },
      {
        "feature": "poverty_quintile",
        "importance": 0.017408
      },
      {
        "feature": "juntos_participant",
        "importance": 0.015072
      },
      {
        "feature": "lang_foreign",
        "importance": 0.014992
      },
      {
        "feature": "es_peruano",
        "importance": 0.013052
      },
      {
        "feature": "lang_aimara",
        "importance": 0.00804
      }
    ]
  },
  "test_2023_calibrated": {
    "metadata": {
      "calibration_method": "platt_sigmoid",
      "platt_a": -5.278337,
      "platt_b": 4.276521,
      "brier_uncalibrated": 0.211542,
      "brier_calibrated": 0.115647,
      "brier_improvement_pct": 45.33,
      "onnx_path": "data/exports/onnx/lightgbm_dropout.onnx",
      "onnx_size_bytes": 101955,
      "onnx_max_abs_diff": 1.026e-07,
      "optimal_threshold": 0.165716,
      "base_model": "lightgbm",
      "frozen_estimator": true,
      "year_note": "Test year is 2023 (ENAHO 2024 unavailable)",
      "generated_at": "2026-02-08T17:57:52.321036+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.261064,
          "roc_auc": 0.650491,
          "f1": 0.31673,
          "precision": 0.264599,
          "recall": 0.394444,
          "brier": 0.115647,
          "log_loss": 0.387781
        },
        "unweighted": {
          "pr_auc": 0.257999,
          "roc_auc": 0.646491,
          "f1": 0.317558,
          "precision": 0.251222,
          "recall": 0.431496,
          "brier": 0.117414,
          "log_loss": 0.392385
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.23781,
          "roc_auc": 0.631401,
          "f1": 0.299333,
          "precision": 0.248683,
          "recall": 0.375893,
          "brier": 0.111753,
          "log_loss": 0.38031
        },
        "unweighted": {
          "pr_auc": 0.230583,
          "roc_auc": 0.62621,
          "f1": 0.286602,
          "precision": 0.224841,
          "recall": 0.395143,
          "brier": 0.113946,
          "log_loss": 0.38507
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.165716,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.2747256715069237,
          "weighted_precision": 0.3654097699073768,
          "weighted_recall": 0.2201025959534286,
          "unweighted_f1": 0.273972602739726,
          "unweighted_precision": 0.36175710594315247,
          "unweighted_recall": 0.2204724409448819
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.005892035077178277,
          "weighted_precision": 0.6956744169841171,
          "weighted_recall": 0.0029585462862839374,
          "unweighted_f1": 0.004707112970711297,
          "unweighted_precision": 0.6428571428571429,
          "unweighted_recall": 0.002362204724409449
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.0,
          "weighted_precision": 0.0,
          "weighted_recall": 0.0,
          "unweighted_f1": 0.0,
          "unweighted_precision": 0.0,
          "unweighted_recall": 0.0
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.0,
          "weighted_precision": 0.0,
          "weighted_recall": 0.0,
          "unweighted_f1": 0.0,
          "unweighted_precision": 0.0,
          "unweighted_recall": 0.0
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.0,
          "weighted_precision": 0.0,
          "weighted_recall": 0.0,
          "unweighted_f1": 0.0,
          "unweighted_precision": 0.0,
          "unweighted_recall": 0.0
        },
        {
          "threshold": 0.165716,
          "is_optimal": true,
          "weighted_f1": 0.31673037259399067,
          "weighted_precision": 0.26459898346182326,
          "weighted_recall": 0.3944438439389667,
          "unweighted_f1": 0.31755843152404867,
          "unweighted_precision": 0.25122249388753054,
          "unweighted_recall": 0.431496062992126
        }
      ]
    },
    "alerta_escuela_comparison": {
      "model": "Alerta Escuela (MINEDU)",
      "algorithm": "LightGBM",
      "data_source": "SIAGIE administrative",
      "roc_auc_range": "0.84-0.89",
      "fnr_range": "57-64%",
      "features": 31,
      "fairness_analysis": "None published",
      "notes": "Uses 5 administrative data sources; trained on SIAGIE records",
      "comparison_caveats": "ROC-AUC is not directly comparable due to different data sources and base rates (~14% ENAHO survey vs ~2% SIAGIE admin). FNR comparison is more meaningful."
    }
  }
}