{
  "logistic_regression": {
    "metadata": {
      "model_type": "LogisticRegression",
      "train_years": [
        2018,
        2019,
        2020,
        2021
      ],
      "validate_year": 2022,
      "test_year": 2023,
      "n_train": 98023,
      "n_validate": 26477,
      "n_test": 25635,
      "n_features": 25,
      "feature_names": [
        "age",
        "is_secundaria_age",
        "es_mujer",
        "lang_castellano",
        "lang_quechua",
        "lang_aimara",
        "lang_other_indigenous",
        "lang_foreign",
        "rural",
        "is_sierra",
        "is_selva",
        "district_dropout_rate_admin_z",
        "nightlight_intensity_z",
        "poverty_index_z",
        "poverty_quintile",
        "es_peruano",
        "has_disability",
        "is_working",
        "juntos_participant",
        "log_income",
        "parent_education_years",
        "census_indigenous_lang_pct_z",
        "census_literacy_rate_z",
        "census_electricity_pct_z",
        "census_water_access_pct_z"
      ],
      "class_weight": "balanced",
      "solver": "lbfgs",
      "max_iter": 1000,
      "C": 1.0,
      "n_iter_actual": 307,
      "convergence": true,
      "year_shift_note": "ENAHO 2024 unavailable; train/val/test shifted back by 1 year from spec",
      "covid_note": "2020 has reduced sample (~13,755 rows) due to COVID phone interviews",
      "weight_note": "freq_weights inflates effective n to ~25M; all p-values are effectively 0. Use odds ratios and coefficient signs for interpretation.",
      "generated_at": "2026-02-13T23:52:10.064120+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.210316,
          "roc_auc": 0.604089,
          "f1": 0.287655,
          "precision": 0.206469,
          "recall": 0.47406,
          "brier": 0.238672,
          "log_loss": 0.670755
        },
        "unweighted": {
          "pr_auc": 0.207701,
          "roc_auc": 0.607024,
          "f1": 0.288733,
          "precision": 0.198313,
          "recall": 0.530709,
          "brier": 0.24923,
          "log_loss": 0.692769
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.19269,
          "roc_auc": 0.598371,
          "f1": 0.270491,
          "precision": 0.194087,
          "recall": 0.446101,
          "brier": 0.237229,
          "log_loss": 0.667752
        },
        "unweighted": {
          "pr_auc": 0.195059,
          "roc_auc": 0.600727,
          "f1": 0.272932,
          "precision": 0.187533,
          "recall": 0.501143,
          "brier": 0.247346,
          "log_loss": 0.688766
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.516815,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.24823395678436225,
          "weighted_precision": 0.14176091896785625,
          "weighted_recall": 0.9972226352114602,
          "unweighted_f1": 0.25168673104908057,
          "unweighted_precision": 0.1439869825172179,
          "unweighted_recall": 0.9986876640419947
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.2561536704619681,
          "weighted_precision": 0.14984150477203917,
          "weighted_recall": 0.8817604917570832,
          "unweighted_f1": 0.2585435009700045,
          "unweighted_precision": 0.1506914847351483,
          "unweighted_recall": 0.9094488188976378
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.28129326746397165,
          "weighted_precision": 0.19160113696567818,
          "weighted_recall": 0.5288650310229124,
          "unweighted_f1": 0.28461197900196067,
          "unweighted_precision": 0.18748437630197484,
          "unweighted_recall": 0.5905511811023622
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.22891932113780697,
          "weighted_precision": 0.26030827003969725,
          "weighted_recall": 0.2042857750933075,
          "unweighted_f1": 0.24678529679179115,
          "unweighted_precision": 0.24427873489328877,
          "unweighted_recall": 0.24934383202099739
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.06359364601802964,
          "weighted_precision": 0.30780731142314954,
          "weighted_recall": 0.035459864798751524,
          "unweighted_f1": 0.0865128660159716,
          "unweighted_precision": 0.2793696275071633,
          "unweighted_recall": 0.051181102362204724
        },
        {
          "threshold": 0.516815,
          "is_optimal": true,
          "weighted_f1": 0.2876547664657711,
          "weighted_precision": 0.20646898819120424,
          "weighted_recall": 0.47406024015575454,
          "unweighted_f1": 0.2887333999714408,
          "unweighted_precision": 0.19831306394664575,
          "unweighted_recall": 0.5307086614173229
        }
      ]
    },
    "coefficients": [
      {
        "feature": "intercept",
        "coefficient": -1.540998,
        "std_error": 0.026339,
        "odds_ratio": 0.214167,
        "p_value": 0.0,
        "ci_lower": -1.592621,
        "ci_upper": -1.489375
      },
      {
        "feature": "age",
        "coefficient": 0.120129,
        "std_error": 0.000333,
        "odds_ratio": 1.127642,
        "p_value": 0.0,
        "ci_lower": 0.119477,
        "ci_upper": 0.12078
      },
      {
        "feature": "is_secundaria_age",
        "coefficient": -0.437803,
        "std_error": 0.002289,
        "odds_ratio": 0.645453,
        "p_value": 0.0,
        "ci_lower": -0.442289,
        "ci_upper": -0.433316
      },
      {
        "feature": "es_mujer",
        "coefficient": -0.043797,
        "std_error": 0.001078,
        "odds_ratio": 0.957148,
        "p_value": 0.0,
        "ci_lower": -0.04591,
        "ci_upper": -0.041684
      },
      {
        "feature": "lang_castellano",
        "coefficient": 0.295223,
        "std_error": 0.013153,
        "odds_ratio": 1.343425,
        "p_value": 0.0,
        "ci_lower": 0.269443,
        "ci_upper": 0.321002
      },
      {
        "feature": "lang_quechua",
        "coefficient": 0.471329,
        "std_error": 0.013316,
        "odds_ratio": 1.602122,
        "p_value": 0.0,
        "ci_lower": 0.445231,
        "ci_upper": 0.497427
      },
      {
        "feature": "lang_aimara",
        "coefficient": 0.346508,
        "std_error": 0.01534,
        "odds_ratio": 1.414121,
        "p_value": 0.0,
        "ci_lower": 0.316443,
        "ci_upper": 0.376574
      },
      {
        "feature": "lang_other_indigenous",
        "coefficient": 0.788016,
        "std_error": 0.013719,
        "odds_ratio": 2.199029,
        "p_value": 0.0,
        "ci_lower": 0.761127,
        "ci_upper": 0.814905
      },
      {
        "feature": "lang_foreign",
        "coefficient": 0.575964,
        "std_error": 0.016696,
        "odds_ratio": 1.778845,
        "p_value": 0.0,
        "ci_lower": 0.543241,
        "ci_upper": 0.608688
      },
      {
        "feature": "rural",
        "coefficient": -0.009975,
        "std_error": 0.001601,
        "odds_ratio": 0.990074,
        "p_value": 0.0,
        "ci_lower": -0.013113,
        "ci_upper": -0.006838
      },
      {
        "feature": "is_sierra",
        "coefficient": -0.072235,
        "std_error": 0.001695,
        "odds_ratio": 0.930312,
        "p_value": 0.0,
        "ci_lower": -0.075558,
        "ci_upper": -0.068912
      },
      {
        "feature": "is_selva",
        "coefficient": -0.077228,
        "std_error": 0.002075,
        "odds_ratio": 0.925679,
        "p_value": 0.0,
        "ci_lower": -0.081294,
        "ci_upper": -0.073161
      },
      {
        "feature": "district_dropout_rate_admin_z",
        "coefficient": -0.003094,
        "std_error": 0.000865,
        "odds_ratio": 0.996911,
        "p_value": 0.00035,
        "ci_lower": -0.00479,
        "ci_upper": -0.001398
      },
      {
        "feature": "nightlight_intensity_z",
        "coefficient": -0.107377,
        "std_error": 0.000652,
        "odds_ratio": 0.898187,
        "p_value": 0.0,
        "ci_lower": -0.108655,
        "ci_upper": -0.106099
      },
      {
        "feature": "poverty_index_z",
        "coefficient": 0.252479,
        "std_error": 0.001704,
        "odds_ratio": 1.287212,
        "p_value": 0.0,
        "ci_lower": 0.249138,
        "ci_upper": 0.255819
      },
      {
        "feature": "poverty_quintile",
        "coefficient": -0.210036,
        "std_error": 0.001226,
        "odds_ratio": 0.810555,
        "p_value": 0.0,
        "ci_lower": -0.21244,
        "ci_upper": -0.207632
      },
      {
        "feature": "es_peruano",
        "coefficient": 0.298483,
        "std_error": 0.020422,
        "odds_ratio": 1.347813,
        "p_value": 0.0,
        "ci_lower": 0.258456,
        "ci_upper": 0.33851
      },
      {
        "feature": "has_disability",
        "coefficient": 0.114813,
        "std_error": 0.001708,
        "odds_ratio": 1.121664,
        "p_value": 0.0,
        "ci_lower": 0.111465,
        "ci_upper": 0.118161
      },
      {
        "feature": "is_working",
        "coefficient": 0.346023,
        "std_error": 0.001814,
        "odds_ratio": 1.413436,
        "p_value": 0.0,
        "ci_lower": 0.342469,
        "ci_upper": 0.349578
      },
      {
        "feature": "juntos_participant",
        "coefficient": -0.033495,
        "std_error": 0.001581,
        "odds_ratio": 0.96706,
        "p_value": 0.0,
        "ci_lower": -0.036593,
        "ci_upper": -0.030397
      },
      {
        "feature": "log_income",
        "coefficient": -0.107299,
        "std_error": 0.000861,
        "odds_ratio": 0.898257,
        "p_value": 0.0,
        "ci_lower": -0.108987,
        "ci_upper": -0.105611
      },
      {
        "feature": "parent_education_years",
        "coefficient": -0.001809,
        "std_error": 0.000154,
        "odds_ratio": 0.998193,
        "p_value": 0.0,
        "ci_lower": -0.00211,
        "ci_upper": -0.001508
      },
      {
        "feature": "census_indigenous_lang_pct_z",
        "coefficient": 0.021599,
        "std_error": 0.000898,
        "odds_ratio": 1.021834,
        "p_value": 0.0,
        "ci_lower": 0.019839,
        "ci_upper": 0.023358
      },
      {
        "feature": "census_literacy_rate_z",
        "coefficient": -0.051628,
        "std_error": 0.000931,
        "odds_ratio": 0.949682,
        "p_value": 0.0,
        "ci_lower": -0.053453,
        "ci_upper": -0.049803
      },
      {
        "feature": "census_electricity_pct_z",
        "coefficient": 0.091742,
        "std_error": 0.00097,
        "odds_ratio": 1.096082,
        "p_value": 0.0,
        "ci_lower": 0.089841,
        "ci_upper": 0.093644
      },
      {
        "feature": "census_water_access_pct_z",
        "coefficient": -0.053554,
        "std_error": 0.000833,
        "odds_ratio": 0.947854,
        "p_value": 0.0,
        "ci_lower": -0.055187,
        "ci_upper": -0.051922
      }
    ]
  },
  "lightgbm": {
    "metadata": {
      "model_type": "LGBMClassifier",
      "train_years": [
        2018,
        2019,
        2020,
        2021
      ],
      "validate_year": 2022,
      "test_year": 2023,
      "n_train": 98023,
      "n_validate": 26477,
      "n_test": 25635,
      "n_features": 25,
      "feature_names": [
        "age",
        "is_secundaria_age",
        "es_mujer",
        "lang_castellano",
        "lang_quechua",
        "lang_aimara",
        "lang_other_indigenous",
        "lang_foreign",
        "rural",
        "is_sierra",
        "is_selva",
        "district_dropout_rate_admin_z",
        "nightlight_intensity_z",
        "poverty_index_z",
        "poverty_quintile",
        "es_peruano",
        "has_disability",
        "is_working",
        "juntos_participant",
        "log_income",
        "parent_education_years",
        "census_indigenous_lang_pct_z",
        "census_literacy_rate_z",
        "census_electricity_pct_z",
        "census_water_access_pct_z"
      ],
      "best_iteration": 34,
      "scale_pos_weight": 4.8019,
      "optuna_n_trials": 100,
      "optuna_best_trial": 61,
      "optuna_best_params": {
        "learning_rate": 0.04721582024302735,
        "num_leaves": 41,
        "max_depth": 9,
        "min_child_samples": 67,
        "subsample": 0.9737802543516294,
        "colsample_bytree": 0.6349400948748561,
        "reg_alpha": 4.0728224206872714e-08,
        "reg_lambda": 0.06964778679288332
      },
      "calibration_note": "scale_pos_weight distorts probability estimates; Phase 7 handles calibration",
      "generated_at": "2026-02-13T23:53:57.017568+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.261634,
          "roc_auc": 0.652212,
          "f1": 0.318822,
          "precision": 0.262651,
          "recall": 0.405554,
          "brier": 0.186222,
          "log_loss": 0.561063
        },
        "unweighted": {
          "pr_auc": 0.258208,
          "roc_auc": 0.64822,
          "f1": 0.321927,
          "precision": 0.253157,
          "recall": 0.441995,
          "brier": 0.192352,
          "log_loss": 0.574519
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.236084,
          "roc_auc": 0.633851,
          "f1": 0.294962,
          "precision": 0.238837,
          "recall": 0.385566,
          "brier": 0.185665,
          "log_loss": 0.560429
        },
        "unweighted": {
          "pr_auc": 0.229553,
          "roc_auc": 0.627259,
          "f1": 0.286176,
          "precision": 0.221217,
          "recall": 0.405143,
          "brier": 0.192491,
          "log_loss": 0.574921
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.454964,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.2572465457032766,
          "weighted_precision": 0.1486742789400765,
          "weighted_recall": 0.9537163502811318,
          "unweighted_f1": 0.25650311662081693,
          "unweighted_precision": 0.1478700766852692,
          "unweighted_recall": 0.9666666666666667
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.3009997710653717,
          "weighted_precision": 0.19631852687911483,
          "weighted_recall": 0.644844870013917,
          "unweighted_f1": 0.2978968596946125,
          "unweighted_precision": 0.1908453303802141,
          "unweighted_recall": 0.678477690288714
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.31122620217990027,
          "weighted_precision": 0.31219357039037515,
          "weighted_recall": 0.3102648104571625,
          "unweighted_f1": 0.31453931741467683,
          "unweighted_precision": 0.3003103365958463,
          "unweighted_recall": 0.33018372703412074
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.17692555251819136,
          "weighted_precision": 0.4075512003808512,
          "weighted_recall": 0.11298783637372009,
          "unweighted_f1": 0.18832467013194723,
          "unweighted_precision": 0.3951342281879195,
          "unweighted_recall": 0.1236220472440945
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.0,
          "weighted_precision": 0.0,
          "weighted_recall": 0.0,
          "unweighted_f1": 0.0,
          "unweighted_precision": 0.0,
          "unweighted_recall": 0.0
        },
        {
          "threshold": 0.454964,
          "is_optimal": true,
          "weighted_f1": 0.31882166684180596,
          "weighted_precision": 0.2626509366037723,
          "weighted_recall": 0.40555368904101885,
          "unweighted_f1": 0.321926973809979,
          "unweighted_precision": 0.25315694527961513,
          "unweighted_recall": 0.441994750656168
        }
      ]
    },
    "feature_importances": [
      {
        "feature": "age",
        "importance": 0.228953
      },
      {
        "feature": "nightlight_intensity_z",
        "importance": 0.142792
      },
      {
        "feature": "census_indigenous_lang_pct_z",
        "importance": 0.101038
      },
      {
        "feature": "census_water_access_pct_z",
        "importance": 0.085519
      },
      {
        "feature": "census_electricity_pct_z",
        "importance": 0.079966
      },
      {
        "feature": "census_literacy_rate_z",
        "importance": 0.076904
      },
      {
        "feature": "log_income",
        "importance": 0.063741
      },
      {
        "feature": "poverty_index_z",
        "importance": 0.062676
      },
      {
        "feature": "district_dropout_rate_admin_z",
        "importance": 0.043442
      },
      {
        "feature": "is_working",
        "importance": 0.041757
      },
      {
        "feature": "parent_education_years",
        "importance": 0.016934
      },
      {
        "feature": "rural",
        "importance": 0.010873
      },
      {
        "feature": "lang_other_indigenous",
        "importance": 0.009323
      },
      {
        "feature": "poverty_quintile",
        "importance": 0.00788
      },
      {
        "feature": "lang_castellano",
        "importance": 0.005948
      },
      {
        "feature": "is_sierra",
        "importance": 0.005383
      },
      {
        "feature": "is_selva",
        "importance": 0.003772
      },
      {
        "feature": "juntos_participant",
        "importance": 0.003124
      },
      {
        "feature": "es_mujer",
        "importance": 0.002982
      },
      {
        "feature": "is_secundaria_age",
        "importance": 0.002883
      },
      {
        "feature": "has_disability",
        "importance": 0.002745
      },
      {
        "feature": "lang_quechua",
        "importance": 0.001365
      },
      {
        "feature": "lang_aimara",
        "importance": 0.0
      },
      {
        "feature": "lang_foreign",
        "importance": 0.0
      },
      {
        "feature": "es_peruano",
        "importance": 0.0
      }
    ],
    "test_2023_final": {
      "weighted": {
        "pr_auc": 0.236084,
        "roc_auc": 0.633851,
        "f1": 0.294962,
        "precision": 0.238837,
        "recall": 0.385566,
        "brier": 0.185665,
        "log_loss": 0.560429
      },
      "unweighted": {
        "pr_auc": 0.229553,
        "roc_auc": 0.627259,
        "f1": 0.286176,
        "precision": 0.221217,
        "recall": 0.405143,
        "brier": 0.192491,
        "log_loss": 0.574921
      }
    }
  },
  "xgboost": {
    "metadata": {
      "model_type": "XGBClassifier",
      "train_years": [
        2018,
        2019,
        2020,
        2021
      ],
      "validate_year": 2022,
      "test_year": 2023,
      "n_train": 98023,
      "n_validate": 26477,
      "n_test": 25635,
      "n_features": 25,
      "feature_names": [
        "age",
        "is_secundaria_age",
        "es_mujer",
        "lang_castellano",
        "lang_quechua",
        "lang_aimara",
        "lang_other_indigenous",
        "lang_foreign",
        "rural",
        "is_sierra",
        "is_selva",
        "district_dropout_rate_admin_z",
        "nightlight_intensity_z",
        "poverty_index_z",
        "poverty_quintile",
        "es_peruano",
        "has_disability",
        "is_working",
        "juntos_participant",
        "log_income",
        "parent_education_years",
        "census_indigenous_lang_pct_z",
        "census_literacy_rate_z",
        "census_electricity_pct_z",
        "census_water_access_pct_z"
      ],
      "best_iteration": 277,
      "scale_pos_weight": 4.8019,
      "optuna_n_trials": 50,
      "optuna_best_trial": 39,
      "optuna_best_params": {
        "learning_rate": 0.012781805654348164,
        "max_depth": 4,
        "min_child_weight": 6,
        "gamma": 0.013629270480097756,
        "subsample": 0.5364002759660965,
        "colsample_bytree": 0.8874445446294317,
        "reg_alpha": 7.670203464752592e-06,
        "reg_lambda": 0.0007164216986216796
      },
      "calibration_note": "scale_pos_weight distorts probability estimates; Phase 7 handles calibration",
      "generated_at": "2026-02-13T23:59:48.687704+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.262597,
          "roc_auc": 0.647994,
          "f1": 0.314671,
          "precision": 0.243873,
          "recall": 0.44339,
          "brier": 0.22419,
          "log_loss": 0.64114
        },
        "unweighted": {
          "pr_auc": 0.259285,
          "roc_auc": 0.643178,
          "f1": 0.312238,
          "precision": 0.229228,
          "recall": 0.489501,
          "brier": 0.233399,
          "log_loss": 0.660457
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.23851,
          "roc_auc": 0.62937,
          "f1": 0.289235,
          "precision": 0.222721,
          "recall": 0.412394,
          "brier": 0.223723,
          "log_loss": 0.640474
        },
        "unweighted": {
          "pr_auc": 0.231343,
          "roc_auc": 0.624123,
          "f1": 0.283049,
          "precision": 0.206275,
          "recall": 0.450857,
          "brier": 0.233702,
          "log_loss": 0.661156
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.500402,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.2501194030377803,
          "weighted_precision": 0.14334315686306814,
          "weighted_recall": 0.9804739899878437,
          "unweighted_f1": 0.25229128478586904,
          "unweighted_precision": 0.1444932238976904,
          "unweighted_recall": 0.9934383202099738
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.2612305164723172,
          "weighted_precision": 0.15265737849714267,
          "weighted_recall": 0.904603671424172,
          "unweighted_f1": 0.25900843805453955,
          "unweighted_precision": 0.15023316388690502,
          "unweighted_recall": 0.9385826771653544
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.3138904343492521,
          "weighted_precision": 0.24270004716755075,
          "weighted_recall": 0.4441803641164697,
          "unweighted_f1": 0.31197864531197866,
          "unweighted_precision": 0.22866226461237465,
          "unweighted_recall": 0.49081364829396323
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.2954116996707804,
          "weighted_precision": 0.3531668259907621,
          "weighted_recall": 0.2538915522682287,
          "unweighted_f1": 0.298138495904691,
          "unweighted_precision": 0.344578313253012,
          "unweighted_recall": 0.2627296587926509
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.18214455349672132,
          "weighted_precision": 0.408773518816606,
          "weighted_recall": 0.11717906669395467,
          "unweighted_f1": 0.17692939244663383,
          "unweighted_precision": 0.4058380414312618,
          "unweighted_recall": 0.1131233595800525
        },
        {
          "threshold": 0.500402,
          "is_optimal": true,
          "weighted_f1": 0.3147463840728755,
          "weighted_precision": 0.24392564167882064,
          "weighted_recall": 0.4435155447262451,
          "unweighted_f1": 0.31237967690633633,
          "unweighted_precision": 0.22932284625783458,
          "unweighted_recall": 0.48976377952755906
        }
      ]
    },
    "feature_importances": [
      {
        "feature": "age",
        "importance": 0.172115
      },
      {
        "feature": "is_working",
        "importance": 0.104391
      },
      {
        "feature": "is_secundaria_age",
        "importance": 0.06438
      },
      {
        "feature": "lang_other_indigenous",
        "importance": 0.057329
      },
      {
        "feature": "nightlight_intensity_z",
        "importance": 0.048793
      },
      {
        "feature": "census_literacy_rate_z",
        "importance": 0.041327
      },
      {
        "feature": "census_electricity_pct_z",
        "importance": 0.040031
      },
      {
        "feature": "is_selva",
        "importance": 0.037527
      },
      {
        "feature": "poverty_index_z",
        "importance": 0.036937
      },
      {
        "feature": "census_water_access_pct_z",
        "importance": 0.036858
      },
      {
        "feature": "census_indigenous_lang_pct_z",
        "importance": 0.03682
      },
      {
        "feature": "lang_castellano",
        "importance": 0.035318
      },
      {
        "feature": "rural",
        "importance": 0.03165
      },
      {
        "feature": "has_disability",
        "importance": 0.031606
      },
      {
        "feature": "log_income",
        "importance": 0.031376
      },
      {
        "feature": "poverty_quintile",
        "importance": 0.028733
      },
      {
        "feature": "district_dropout_rate_admin_z",
        "importance": 0.025338
      },
      {
        "feature": "lang_foreign",
        "importance": 0.021775
      },
      {
        "feature": "parent_education_years",
        "importance": 0.021661
      },
      {
        "feature": "is_sierra",
        "importance": 0.020582
      },
      {
        "feature": "es_mujer",
        "importance": 0.018462
      },
      {
        "feature": "lang_aimara",
        "importance": 0.017119
      },
      {
        "feature": "juntos_participant",
        "importance": 0.014482
      },
      {
        "feature": "es_peruano",
        "importance": 0.013925
      },
      {
        "feature": "lang_quechua",
        "importance": 0.011467
      }
    ]
  },
  "test_2023_calibrated": {
    "metadata": {
      "calibration_method": "platt_sigmoid",
      "platt_a": -6.236085,
      "platt_b": 4.442308,
      "brier_uncalibrated": 0.186222,
      "brier_calibrated": 0.11555,
      "brier_improvement_pct": 37.95,
      "onnx_path": "data/exports/onnx/lightgbm_dropout.onnx",
      "onnx_size_bytes": 101441,
      "onnx_max_abs_diff": 9.96e-08,
      "optimal_threshold": 0.167268,
      "base_model": "lightgbm",
      "frozen_estimator": true,
      "year_note": "Test year is 2023 (ENAHO 2024 unavailable)",
      "generated_at": "2026-02-13T23:59:51.974064+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.261634,
          "roc_auc": 0.652212,
          "f1": 0.318822,
          "precision": 0.262651,
          "recall": 0.405554,
          "brier": 0.11555,
          "log_loss": 0.387356
        },
        "unweighted": {
          "pr_auc": 0.258208,
          "roc_auc": 0.64822,
          "f1": 0.321927,
          "precision": 0.253157,
          "recall": 0.441995,
          "brier": 0.11732,
          "log_loss": 0.392065
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.236084,
          "roc_auc": 0.633851,
          "f1": 0.294962,
          "precision": 0.238837,
          "recall": 0.385566,
          "brier": 0.111773,
          "log_loss": 0.380528
        },
        "unweighted": {
          "pr_auc": 0.229553,
          "roc_auc": 0.627259,
          "f1": 0.286176,
          "precision": 0.221217,
          "recall": 0.405143,
          "brier": 0.113999,
          "log_loss": 0.38529
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.167268,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.26855914932974095,
          "weighted_precision": 0.3626765702211205,
          "weighted_recall": 0.21322546503555978,
          "unweighted_f1": 0.2733366029099232,
          "unweighted_precision": 0.3623753792804508,
          "unweighted_recall": 0.2194225721784777
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.011364473266743218,
          "weighted_precision": 0.6504179073000395,
          "weighted_recall": 0.00573231578150412,
          "unweighted_f1": 0.0036610878661087866,
          "unweighted_precision": 0.5,
          "unweighted_recall": 0.001837270341207349
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.0,
          "weighted_precision": 0.0,
          "weighted_recall": 0.0,
          "unweighted_f1": 0.0,
          "unweighted_precision": 0.0,
          "unweighted_recall": 0.0
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.0,
          "weighted_precision": 0.0,
          "weighted_recall": 0.0,
          "unweighted_f1": 0.0,
          "unweighted_precision": 0.0,
          "unweighted_recall": 0.0
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.0,
          "weighted_precision": 0.0,
          "weighted_recall": 0.0,
          "unweighted_f1": 0.0,
          "unweighted_precision": 0.0,
          "unweighted_recall": 0.0
        },
        {
          "threshold": 0.167268,
          "is_optimal": true,
          "weighted_f1": 0.31882166684180596,
          "weighted_precision": 0.2626509366037723,
          "weighted_recall": 0.40555368904101885,
          "unweighted_f1": 0.321926973809979,
          "unweighted_precision": 0.25315694527961513,
          "unweighted_recall": 0.441994750656168
        }
      ]
    },
    "alerta_escuela_comparison": {
      "model": "Alerta Escuela (MINEDU)",
      "algorithm": "LightGBM",
      "data_source": "SIAGIE administrative",
      "roc_auc_range": "0.84-0.89",
      "fnr_range": "57-64%",
      "features": 31,
      "fairness_analysis": "None published",
      "notes": "Uses 5 administrative data sources; trained on SIAGIE records",
      "comparison_caveats": "ROC-AUC is not directly comparable due to different data sources and base rates (~14% ENAHO survey vs ~2% SIAGIE admin). FNR comparison is more meaningful."
    }
  },
  "random_forest": {
    "metadata": {
      "model_type": "RandomForestClassifier",
      "train_years": [
        2018,
        2019,
        2020,
        2021
      ],
      "validate_year": 2022,
      "test_year": 2023,
      "n_train": 98023,
      "n_validate": 26477,
      "n_test": 25635,
      "n_features": 25,
      "feature_names": [
        "age",
        "is_secundaria_age",
        "es_mujer",
        "lang_castellano",
        "lang_quechua",
        "lang_aimara",
        "lang_other_indigenous",
        "lang_foreign",
        "rural",
        "is_sierra",
        "is_selva",
        "district_dropout_rate_admin_z",
        "nightlight_intensity_z",
        "poverty_index_z",
        "poverty_quintile",
        "es_peruano",
        "has_disability",
        "is_working",
        "juntos_participant",
        "log_income",
        "parent_education_years",
        "census_indigenous_lang_pct_z",
        "census_literacy_rate_z",
        "census_electricity_pct_z",
        "census_water_access_pct_z"
      ],
      "optuna_n_trials": 50,
      "optuna_best_trial": 13,
      "optuna_best_params": {
        "n_estimators": 242,
        "max_depth": 10,
        "min_samples_split": 17,
        "min_samples_leaf": 9,
        "max_features": "log2"
      },
      "generated_at": "2026-02-17T14:46:11.484303+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.261323,
          "roc_auc": 0.647441,
          "f1": 0.315168,
          "precision": 0.228191,
          "recall": 0.509288,
          "brier": 0.213587,
          "log_loss": 0.618467
        },
        "unweighted": {
          "pr_auc": 0.261082,
          "roc_auc": 0.647839,
          "f1": 0.317482,
          "precision": 0.221978,
          "recall": 0.557218,
          "brier": 0.221897,
          "log_loss": 0.63624
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.237251,
          "roc_auc": 0.63069,
          "f1": 0.288459,
          "precision": 0.207563,
          "recall": 0.472682,
          "brier": 0.213684,
          "log_loss": 0.619364
        },
        "unweighted": {
          "pr_auc": 0.229136,
          "roc_auc": 0.627105,
          "f1": 0.285942,
          "precision": 0.19819,
          "recall": 0.513143,
          "brier": 0.222689,
          "log_loss": 0.638022
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.471598,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.2516510470506417,
          "weighted_precision": 0.14433827641070074,
          "weighted_recall": 0.9810231523406506,
          "unweighted_f1": 0.25305958670500905,
          "unweighted_precision": 0.14500306560392398,
          "unweighted_recall": 0.9931758530183727
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.26679751899347154,
          "weighted_precision": 0.15791044904627463,
          "weighted_recall": 0.8593882511351336,
          "unweighted_f1": 0.26477941459286897,
          "unweighted_precision": 0.15512190725134076,
          "unweighted_recall": 0.9034120734908136
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.30680786014841793,
          "weighted_precision": 0.2597341327310232,
          "weighted_recall": 0.37472172289518124,
          "unweighted_f1": 0.31684531419018586,
          "unweighted_precision": 0.2533417203962887,
          "unweighted_recall": 0.42283464566929135
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.27427558052918743,
          "weighted_precision": 0.3521106927244353,
          "weighted_recall": 0.22462218156906955,
          "unweighted_f1": 0.2855369335816263,
          "unweighted_precision": 0.3492786636294609,
          "unweighted_recall": 0.24146981627296588
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.07385793258254657,
          "weighted_precision": 0.4481649586371961,
          "weighted_recall": 0.040245185145470375,
          "unweighted_f1": 0.06174039863879436,
          "unweighted_precision": 0.41776315789473684,
          "unweighted_recall": 0.03333333333333333
        },
        {
          "threshold": 0.471598,
          "is_optimal": true,
          "weighted_f1": 0.315168320443182,
          "weighted_precision": 0.2281911623929596,
          "weighted_recall": 0.509288195077412,
          "unweighted_f1": 0.31748168087333634,
          "unweighted_precision": 0.22197825177749894,
          "unweighted_recall": 0.5572178477690288
        }
      ]
    },
    "feature_importances": [
      {
        "feature": "age",
        "importance": 0.194321
      },
      {
        "feature": "nightlight_intensity_z",
        "importance": 0.09504
      },
      {
        "feature": "log_income",
        "importance": 0.083418
      },
      {
        "feature": "census_water_access_pct_z",
        "importance": 0.076863
      },
      {
        "feature": "poverty_index_z",
        "importance": 0.07652
      },
      {
        "feature": "census_literacy_rate_z",
        "importance": 0.07473
      },
      {
        "feature": "census_electricity_pct_z",
        "importance": 0.069899
      },
      {
        "feature": "census_indigenous_lang_pct_z",
        "importance": 0.069434
      },
      {
        "feature": "district_dropout_rate_admin_z",
        "importance": 0.064563
      },
      {
        "feature": "is_working",
        "importance": 0.053691
      },
      {
        "feature": "parent_education_years",
        "importance": 0.030476
      },
      {
        "feature": "is_secundaria_age",
        "importance": 0.018993
      },
      {
        "feature": "poverty_quintile",
        "importance": 0.016227
      },
      {
        "feature": "rural",
        "importance": 0.012198
      },
      {
        "feature": "has_disability",
        "importance": 0.012176
      },
      {
        "feature": "lang_castellano",
        "importance": 0.010639
      },
      {
        "feature": "es_mujer",
        "importance": 0.008587
      },
      {
        "feature": "is_sierra",
        "importance": 0.006879
      },
      {
        "feature": "lang_other_indigenous",
        "importance": 0.006688
      },
      {
        "feature": "juntos_participant",
        "importance": 0.006311
      },
      {
        "feature": "is_selva",
        "importance": 0.006226
      },
      {
        "feature": "lang_quechua",
        "importance": 0.004978
      },
      {
        "feature": "lang_aimara",
        "importance": 0.000653
      },
      {
        "feature": "lang_foreign",
        "importance": 0.000337
      },
      {
        "feature": "es_peruano",
        "importance": 0.000151
      }
    ]
  },
  "mlp": {
    "metadata": {
      "model_type": "MLPClassifier",
      "train_years": [
        2018,
        2019,
        2020,
        2021
      ],
      "validate_year": 2022,
      "test_year": 2023,
      "n_train": 98023,
      "n_validate": 26477,
      "n_test": 25635,
      "n_features": 25,
      "feature_names": [
        "age",
        "is_secundaria_age",
        "es_mujer",
        "lang_castellano",
        "lang_quechua",
        "lang_aimara",
        "lang_other_indigenous",
        "lang_foreign",
        "rural",
        "is_sierra",
        "is_selva",
        "district_dropout_rate_admin_z",
        "nightlight_intensity_z",
        "poverty_index_z",
        "poverty_quintile",
        "es_peruano",
        "has_disability",
        "is_working",
        "juntos_participant",
        "log_income",
        "parent_education_years",
        "census_indigenous_lang_pct_z",
        "census_literacy_rate_z",
        "census_electricity_pct_z",
        "census_water_access_pct_z"
      ],
      "hidden_layer_sizes": [
        155,
        237
      ],
      "scaler_fitted": true,
      "sample_weight_used": true,
      "n_iter": 24,
      "optuna_n_trials": 50,
      "optuna_best_trial": 5,
      "optuna_best_params": {
        "n_layers": 2,
        "h0": 155,
        "h1": 237,
        "alpha": 0.25735437830342034,
        "lr": 0.00041587908420982257,
        "batch_size": 256
      },
      "generated_at": "2026-02-17T19:15:30.148500+00:00"
    },
    "metrics": {
      "validate_2022": {
        "weighted": {
          "pr_auc": 0.238016,
          "roc_auc": 0.629539,
          "f1": 0.301679,
          "precision": 0.251449,
          "recall": 0.376987,
          "brier": 0.117867,
          "log_loss": 0.395862
        },
        "unweighted": {
          "pr_auc": 0.234913,
          "roc_auc": 0.629509,
          "f1": 0.304882,
          "precision": 0.243604,
          "recall": 0.407349,
          "brier": 0.119993,
          "log_loss": 0.401416
        }
      },
      "test_2023": {
        "weighted": {
          "pr_auc": 0.210233,
          "roc_auc": 0.607198,
          "f1": 0.27936,
          "precision": 0.235281,
          "recall": 0.343762,
          "brier": 0.114962,
          "log_loss": 0.390421
        },
        "unweighted": {
          "pr_auc": 0.20689,
          "roc_auc": 0.604836,
          "f1": 0.273745,
          "precision": 0.219668,
          "recall": 0.363143,
          "brier": 0.117074,
          "log_loss": 0.395369
        }
      }
    },
    "threshold_analysis": {
      "optimal_threshold": 0.204537,
      "optimization_target": "max_weighted_f1",
      "thresholds": [
        {
          "threshold": 0.3,
          "weighted_f1": 0.21505513631140605,
          "weighted_precision": 0.32684581974432636,
          "weighted_recall": 0.16024629005745616,
          "unweighted_f1": 0.22233536999321113,
          "unweighted_precision": 0.31460134486071084,
          "unweighted_recall": 0.17191601049868765
        },
        {
          "threshold": 0.4,
          "weighted_f1": 0.09124063774906474,
          "weighted_precision": 0.3906089230199787,
          "weighted_recall": 0.05165302102528683,
          "unweighted_f1": 0.08711684719981562,
          "unweighted_precision": 0.3572778827977316,
          "unweighted_recall": 0.049606299212598425
        },
        {
          "threshold": 0.5,
          "weighted_f1": 0.024007320911453602,
          "weighted_precision": 0.4273055460732153,
          "weighted_recall": 0.012350607747146256,
          "unweighted_f1": 0.021844043688087376,
          "unweighted_precision": 0.33858267716535434,
          "unweighted_recall": 0.011286089238845144
        },
        {
          "threshold": 0.6,
          "weighted_f1": 0.002794196968998744,
          "weighted_precision": 0.30611608276889885,
          "weighted_recall": 0.0014035040065575866,
          "unweighted_f1": 0.004171011470281543,
          "unweighted_precision": 0.3076923076923077,
          "unweighted_recall": 0.002099737532808399
        },
        {
          "threshold": 0.7,
          "weighted_f1": 0.0006094270104864773,
          "weighted_precision": 0.32853764433443805,
          "weighted_recall": 0.00030499638459980733,
          "unweighted_f1": 0.0010484927916120576,
          "unweighted_precision": 0.4,
          "unweighted_recall": 0.0005249343832020997
        },
        {
          "threshold": 0.204537,
          "is_optimal": true,
          "weighted_f1": 0.3017898927411379,
          "weighted_precision": 0.251530392881143,
          "weighted_recall": 0.3771500645190679,
          "unweighted_f1": 0.30504812414064036,
          "unweighted_precision": 0.24372253609541744,
          "unweighted_recall": 0.40761154855643045
        }
      ]
    },
    "permutation_feature_importance": [
      {
        "feature": "age",
        "importance": 0.308375
      },
      {
        "feature": "poverty_index_z",
        "importance": 0.116586
      },
      {
        "feature": "poverty_quintile",
        "importance": 0.075717
      },
      {
        "feature": "census_electricity_pct_z",
        "importance": 0.062452
      },
      {
        "feature": "is_working",
        "importance": 0.045966
      },
      {
        "feature": "nightlight_intensity_z",
        "importance": 0.039017
      },
      {
        "feature": "juntos_participant",
        "importance": 0.037254
      },
      {
        "feature": "district_dropout_rate_admin_z",
        "importance": 0.033734
      },
      {
        "feature": "is_sierra",
        "importance": 0.029514
      },
      {
        "feature": "parent_education_years",
        "importance": 0.029198
      },
      {
        "feature": "census_water_access_pct_z",
        "importance": 0.02756
      },
      {
        "feature": "lang_castellano",
        "importance": 0.023588
      },
      {
        "feature": "lang_quechua",
        "importance": 0.023284
      },
      {
        "feature": "log_income",
        "importance": 0.02285
      },
      {
        "feature": "census_indigenous_lang_pct_z",
        "importance": 0.021438
      },
      {
        "feature": "has_disability",
        "importance": 0.018858
      },
      {
        "feature": "rural",
        "importance": 0.017631
      },
      {
        "feature": "is_selva",
        "importance": 0.017218
      },
      {
        "feature": "census_literacy_rate_z",
        "importance": 0.013786
      },
      {
        "feature": "lang_other_indigenous",
        "importance": 0.012877
      },
      {
        "feature": "is_secundaria_age",
        "importance": 0.010536
      },
      {
        "feature": "lang_foreign",
        "importance": 0.004472
      },
      {
        "feature": "es_mujer",
        "importance": 0.003984
      },
      {
        "feature": "lang_aimara",
        "importance": 0.003923
      },
      {
        "feature": "es_peruano",
        "importance": 0.000182
      }
    ]
  }
}